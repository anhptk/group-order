import{a as Z,b as ee}from"./chunk-6GBTJKMQ.js";import{Ba as K,Ca as Q,Da as W,Ea as X,Ga as Y,Ha as te,Ia as ie,ca as k,ga as G,ja as L,la as U,na as B,oa as H,pa as O,ra as x,sa as V,ua as z,va as R,xa as $,ya as J}from"./chunk-S4MYAB2F.js";import{$b as C,Bb as p,Cb as E,Db as I,Eb as D,Fb as o,Gb as n,Hb as d,O as F,Ob as w,Qb as f,Qc as q,Za as g,Zb as m,_b as N,ab as s,ac as P,bb as u,cc as v,da as S,gc as A,hc as j,ia as M,na as h,ob as T,t as y,ub as c,wb as _}from"./chunk-4N56W5ZJ.js";var b=class t{constructor(e){Object.assign(this,e)}static createFromApiModel(e){return new t({id:e.id,amount:e.amount,createdAt:new Date(e.created_at),fromMember:e.from_member,toMember:e.to_member,transactionType:e.type})}};var re=(()=>{let e=class e{constructor(i){this._requestHelper=i}query(i){return this._requestHelper.get("/transactions",{params:i})}trade(i,r){return this._requestHelper.post("/transactions",{to_member:i,amount:r})}};e.\u0275fac=function(r){return new(r||e)(M(Y))},e.\u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function me(t,e){if(t&1&&(o(0,"li"),m(1),A(2,"date"),n()),t&2){let a=e.$implicit;s(),P("On ",j(2,4,a.createdAt),", amount of ",a.amount," has been transferred from ",a.fromMember.name," to ",a.toMember.name,". ")}}function se(t,e){if(t&1&&(o(0,"ul"),I(1,me,3,6,"li",null,E),n()),t&2){let a=f(2);s(),D(a.transactions)}}function le(t,e){t&1&&(o(0,"div",0),m(1,"No transactions found."),n())}function ce(t,e){if(t&1&&c(0,se,3,0,"ul")(1,le,2,0,"div",0),t&2){let a=f();p((a.transactions==null?null:a.transactions.length)>0?0:1)}}var oe=(()=>{let e=class e{constructor(i){this._transactionService=i,this.isLoading=T(!0)}ngOnInit(){this._getTransactions()}_getTransactions(){this.isLoading.set(!0),this._transactionService.query().pipe(F(()=>this.isLoading.set(!1)),y(i=>i.map(r=>b.createFromApiModel(r)))).subscribe(i=>this.transactions=i)}};e.\u0275fac=function(r){return new(r||e)(u(re))},e.\u0275cmp=h({type:e,selectors:[["app-transactions"]],standalone:!0,features:[v],decls:1,vars:1,consts:[[1,"text-center","mt-4"]],template:function(r,l){r&1&&c(0,ce,2,1),r&2&&p(l.isLoading()?-1:0)},dependencies:[q]});let t=e;return t})();function pe(t,e){if(t&1&&(o(0,"p"),m(1),n(),o(2,"p"),m(3),n(),d(4,"img",7),o(5,"p"),m(6),n()),t&2){let a=f();s(),N(a.member.name),s(2),C("",a.member.email," "),s(),_("src",a.member.picture,g),s(2),C("Balance: ",a.member.balance,"")}}function de(t,e){t&1&&d(0,"app-transactions")}var qe=(()=>{let e=class e{constructor(i,r){this._appDataService=i,this._securityService=r,this.mainForm=this._constructForm()}ngOnInit(){this._appDataService.currentUser$.subscribe(i=>{this.member=i,this.mainForm.patchValue({name:this.member?.name,picture:this.member?.picture})})}_constructForm(){return new O({name:new x(null,[U.required]),picture:new x(null)})}update(){let i=this._preparePayload();this._securityService.updateCurrentUser(i).subscribe(()=>{this._appDataService.initializeUser(),this.mainForm.markAsPristine()})}_preparePayload(){let i={};return this.mainForm.controls.name.dirty&&(i.name=this.mainForm.controls.name.value),this.mainForm.controls.picture.dirty&&(i.picture=this.mainForm.controls.picture.value),i}};e.\u0275fac=function(r){return new(r||e)(u(ie),u(te))},e.\u0275cmp=h({type:e,selectors:[["app-member-profile"]],standalone:!0,features:[v],decls:25,vars:4,consts:[[1,"text-align-center"],[1,"p-4","w-50"],[3,"formGroup"],[1,"w-100","mt-2"],["matInput","","placeholder","Name","formControlName","name"],["matInput","","placeholder","Enter image url","formControlName","picture"],["mat-flat-button","","color","primary","aria-label","Add row",1,"mt-2",3,"click","disabled"],["alt","Profile image","width","100","height","100",3,"src"]],template:function(r,l){r&1&&(o(0,"section",0)(1,"h1"),m(2,"Profile"),n(),c(3,pe,7,4),n(),d(4,"mat-divider"),o(5,"section",1)(6,"h3"),m(7,"Update profile"),n(),o(8,"form",2)(9,"mat-form-field",3)(10,"mat-label"),m(11,"Name"),n(),d(12,"input",4),n(),o(13,"mat-form-field",3)(14,"mat-label"),m(15,"Profile image url"),n(),d(16,"input",5),n(),o(17,"button",6),w("click",function(){return l.update()}),o(18,"mat-icon"),m(19,"save"),n(),m(20," Save "),n()()(),o(21,"section",1)(22,"h3"),m(23,"Transaction history"),n(),c(24,de,1,0,"app-transactions"),n()),r&2&&(s(3),p(l.member?3:-1),s(5),_("formGroup",l.mainForm),s(9),_("disabled",!l.mainForm.dirty||!l.mainForm.valid),s(7),p(l.member?24:-1))},dependencies:[ee,Z,$,V,L,B,H,z,R,Q,K,J,X,W,k,G,oe]});let t=e;return t})();export{qe as MemberProfileComponent};
